<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <title>Groupes de discussion</title>
    <link rel="stylesheet" href="../ressources/css/groupes.css" />
</h:head>

<h:body>
    <h:form>
        <h2>Créer un nouveau groupe</h2>

        <h:panelGrid columns="2" cellpadding="5">
            <h:outputLabel value="Nom du groupe :" for="nomGroupe" />
            <h:inputText id="nomGroupe" value="#{groupeBean.nomGroupe}" required="true" />
        </h:panelGrid>

        <h:commandButton value="Créer le groupe" action="#{groupeBean.creerGroupe}" styleClass="btn btn-success" />
        <h:messages globalOnly="true" layout="table" style="color:green; margin-top:10px;" />
    </h:form>

    <hr />

    <h2>Mes groupes</h2>
    <h:dataTable value="#{groupeBean.groupes}" var="g" border="1" style="width:100%; text-align:left;">
        <h:column>
            <f:facet name="header">Nom du groupe</f:facet>
            #{g.nom}
        </h:column>

        <h:column>
            <f:facet name="header">Membres</f:facet>
            <ui:repeat value="#{g.membres}" var="m">
                #{m.nom} #{m.prenom}<br />
            </ui:repeat>
        </h:column>

<!--        <h:column>-->
<!--            <f:facet name="header">Actions</f:facet>-->
<!--            <h:commandLink value="Ouvrir" action="chat.xhtml?conversationId=#{g.id}" />-->
<!--        </h:column>-->
    </h:dataTable>

    <hr />

    <h2>Invitations reçues</h2>
    <h:dataTable value="#{groupeBean.invitationsRecues}" var="inv" border="1" style="width:100%; text-align:left;">
        <h:column>
            <f:facet name="header">De</f:facet>
            #{inv.expediteur.nom} #{inv.expediteur.prenom}
        </h:column>

        <h:column>
            <f:facet name="header">Groupe</f:facet>
            #{inv.conversation.nom}
        </h:column>

        <h:column>
            <f:facet name="header">Actions</f:facet>
            <h:commandButton value="Accepter" action="#{groupeBean.accepteerInvitation(inv.id)}" style="color:green;" />
            <h:commandButton value="Refuser" action="#{groupeBean.refuserInvitation(inv.id)}" style="color:red;" />
        </h:column>
    </h:dataTable>
</h:body>
</html>
